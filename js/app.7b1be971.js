(function(t){function e(e){for(var a,l,o=e[0],i=e[1],s=e[2],u=0,p=[];u<o.length;u++)l=o[u],Object.prototype.hasOwnProperty.call(c,l)&&c[l]&&p.push(c[l][0]),c[l]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a]);h&&h(e);while(p.length)p.shift()();return n.push.apply(n,s||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],a=!0,o=1;o<r.length;o++){var i=r[o];0!==c[i]&&(a=!1)}a&&(n.splice(e--,1),t=l(l.s=r[0]))}return t}var a={},c={app:0},n=[];function l(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,l),r.l=!0,r.exports}l.m=t,l.c=a,l.d=function(t,e,r){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)l.d(r,a,function(e){return t[e]}.bind(null,a));return r},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/Xlsx-EasyExportExcelWithChars/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],i=o.push.bind(o);o.push=e,o=o.slice();for(var s=0;s<o.length;s++)e(o[s]);var h=i;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";r("85ec")},1:function(t,e){},2:function(t,e){},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("img",{attrs:{alt:"Vue logo",src:r("cf05")}}),a("br"),a("button",{staticStyle:{margin:"0 auto"},on:{click:t.getChartExcel}},[t._v(" 导出带图标的excel表格 ")])])},n=[],l=r("dee4"),o=r.n(l),i=r("21a6"),s=r.n(i),h={name:"App",components:{},methods:{getChartExcel:function(){var t=new o.a,e={chart:"column",titles:["Price"],fields:["Apple","Blackberry","Strawberry","Cowberry","jasonchen","lemon","orange"],data:{Price:{Apple:100,Blackberry:250,Strawberry:150,Cowberry:120,jasonchen:240,lemon:130,orange:90}},chartTitle:"Area chart"};t.generate(e,(function(t,e){if(t)console.error(t);else{var r=new Blob([e]);s.a.saveAs(r,"chart.xlsx")}}))}}},u=h,p=(r("034f"),r("2877")),f=Object(p["a"])(u,c,n,!1,null,null,null),d=f.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(d)}}).$mount("#app")},"85ec":function(t,e,r){},cf05:function(t,e,r){t.exports=r.p+"img/logo.82b9c7a5.png"},dee4:function(t,e,r){(function(e,a){r("c975"),r("d81d"),r("d3b7"),r("ddb0");var c=r("c46f"),n=r("ab5c"),l=r("7c39"),o=r("083c"),i=r("1d21"),s=r("bc3a"),h=r("422b"),u=n.Model.extend({read:function(t,e){var r=this,a=r.zip.file(t.file).asText(),c=new o.Parser({explicitArray:!1});c.parseString(a,(function(t,r){if(t)return new i(t,"getXML");e(t,r)}))},write:function(t){var r=this,a=new o.Builder,c=a.buildObject(t.object);r.zip.file(t.file,new e(c),{base64:!0})},getColName:function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return t--,t<26?e[t]:e[t/26-1|0]+e[t%26]},getStr:function(t){var e=this;if(!e.str.hasOwnProperty(t))throw new i("getStr: Unknown string: "+t);return e.str[t]},writeTable:function(t){var e=this;e.read({file:"xl/worksheets/sheet2.xml"},(function(r,a){if(r)return t(new i(r,"writeTable"));a.worksheet.dimension.$.ref="A1:"+e.getColName(e.titles.length+1)+(e.fields.length+1);var n=[{$:{r:1,spans:"1:"+(e.titles.length+1)},c:c.map(e.titles,(function(t,r){return{$:{r:e.getColName(r+2)+1,t:"s"},v:e.getStr(t)}}))}];c.each(e.fields,(function(t,r){var a={$:{r:r+2,spans:"1:"+(e.titles.length+1)}},l=[{$:{r:"A"+(r+2),t:"s"},v:e.getStr(t)}];c.each(e.titles,(function(a,c){l.push({$:{r:e.getColName(c+2)+(r+2)},v:e.data[a][t]})})),a.c=l,n.push(a)})),a.worksheet.sheetData.row=n,console.log("o",a,n),e.write({file:"xl/worksheets/sheet2.xml",object:a}),t()}))},writeStrings:function(t){var e=this;e.read({file:"xl/sharedStrings.xml"},(function(r,a){if(r)return t(new i(r,"writeStrings"));a.sst.$.count=e.titles.length+e.fields.length,a.sst.$.uniqueCount=a.sst.$.count;var n=[];c.each(e.titles,(function(t){n.push({t:t})})),c.each(e.fields,(function(t){n.push({t:t})})),e.str={},c.each(n,(function(t,r){e.str[t.t]=r})),a.sst.si=n,e.write({file:"xl/sharedStrings.xml",object:a}),t()}))},removeUnusedCharts:function(t){var e=this;if("charts"==e.tplName){var r=[];c.each(["line","radar","area","scatter","pie"],(function(r){e.charts[r]?l(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:"+r+"Chart"]):delete t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:"+r+"Chart"]})),e.charts["column"]||e.charts["bar"]?e.charts["column"]&&!e.charts["bar"]?(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"]=t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"][0],l(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"])):!e.charts["column"]&&e.charts["bar"]?(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"]=t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"][1],l(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"])):(l(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"][0]),l(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"][1])):delete t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"];var a=[];c.each(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:catAx"],(function(t){r.indexOf(t["c:axId"].$.val)>-1&&a.push(t)})),t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:catAx"]=a;var n=[];c.each(t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:valAx"],(function(t){r.indexOf(t["c:axId"].$.val)>-1&&n.push(t)})),t["c:chartSpace"]["c:chart"]["c:plotArea"]["c:valAx"]=n}function l(t){c.each(t["c:axId"],(function(t){r.push(t.$.val)}))}},writeChart:function(t){var e=this;e.read({file:"xl/charts/chart1.xml"},(function(r,a){if(r)return t(new i(r,"writeChart"));var n={};c.each(e.titles,(function(t,r){var a=e.data[t].chart||e.chart,l={"c:idx":{$:{val:r}},"c:order":{$:{val:r}},"c:tx":{"c:strRef":{"c:f":"Table!$"+e.getColName(r+2)+"$1","c:strCache":{"c:ptCount":{$:{val:1}},"c:pt":{$:{idx:0},"c:v":t}}}},"c:cat":{"c:strRef":{"c:f":"Table!$A$2:$A$"+(e.fields.length+1),"c:strCache":{"c:ptCount":{$:{val:e.fields.length}},"c:pt":c.map(e.fields,(function(t,e){return{$:{idx:e},"c:v":t}}))}}},"c:val":{"c:numRef":{"c:f":"Table!$"+e.getColName(r+2)+"$2:$"+e.getColName(r+2)+"$"+(e.fields.length+1),"c:numCache":{"c:formatCode":"General","c:ptCount":{$:{val:e.fields.length}},"c:pt":c.map(e.fields,(function(r,a){return{$:{idx:a},"c:v":e.data[t][r]}}))}}}};"scatter"==a&&(l["c:xVal"]=l["c:cat"],delete l["c:cat"],l["c:yVal"]=l["c:val"],delete l["c:val"],l["c:spPr"]={"a:ln":{$:{w:28575},"a:noFill":""}}),n[a]=n[a]||[],n[a].push(l)})),c.each(n,(function(t,r){"column"==r?"charts"==e.tplName?a["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"][0]["c:ser"]=t:a["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"]["c:ser"]=t:"bar"==r?"charts"==e.tplName?a["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"][1]["c:ser"]=t:a["c:chartSpace"]["c:chart"]["c:plotArea"]["c:barChart"]["c:ser"]=t:a["c:chartSpace"]["c:chart"]["c:plotArea"]["c:"+r+"Chart"]["c:ser"]=t})),e.removeUnusedCharts(a),e.chartTitle&&e.writeTitle(a,e.chartTitle),e.write({file:"xl/charts/chart1.xml",object:a}),t()}))},writeTitle:function(t,e){t["c:chartSpace"]["c:chart"]["c:title"]={"c:tx":{"c:rich":{"a:bodyPr":{},"a:lstStyle":{},"a:p":{"a:pPr":{"a:defRPr":{}},"a:r":{"a:rPr":{$:{lang:"ru-RU"}},"a:t":e}}}},"c:layout":{},"c:overlay":{$:{val:"0"}}},t["c:chartSpace"]["c:chart"]["c:autoTitleDeleted"]={$:{val:"0"}}},setTemplateName:function(){var t=this,e={};c.each(t.data,(function(r){e[r.chart||t.chart]=!0})),t.charts=e,e["radar"]?t.tplName="radar":e["scatter"]?t.tplName="scatter":e["pie"]?t.tplName="pie":1!=c.keys(e).length?t.tplName="charts":t.tplName=c.keys(e)[0]},generate:function(t,e){var r=this;t.type=t.type||"nodebuffer",c.extend(r,t),h.series([function(t){r.zip=new l,r.setTemplateName();var e=r.templatePath?r.templatePath:a+"template/"+r.tplName+".xlsx";console.log("path:",e),s({url:e,method:"GET",responseType:"arraybuffer"}).then((function(e){console.log("response",e),r.zip.load(e.data),t()}))},function(t){r.writeStrings(t)},function(t){c.each(r.titles,(function(t){r.data[t]=r.data[t]||{},c.each(r.fields,(function(e){r.data[t][e]=r.data[t][e]||0}))})),r.writeTable(t)},function(t){r.writeChart(t)}],(function(t){if(t)return e(new i(t,"build"));var a=r.zip.generate({type:r.type});e(null,a)}))}});t.exports=u}).call(this,r("b639").Buffer,"/")}});